(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/sku/index"],{"257b":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i("3f95"),o=function(){i.e("components/uni-number-box").then(function(){return resolve(i("f699"))}.bind(null,i)).catch(i.oe)},n={name:"sku",components:{uniNumberBox:o},props:{getList:{type:Object,default:function(){return{}}},cartDetails:{type:Object,default:function(){return{}}},update:{type:Boolean,default:!1},order:{type:Boolean,default:!1},buy:{type:Boolean,default:!1}},data:function(){return{cartGood:{number:1,price:""},specSelected:[],SKUResult:{},good_sku:{},selectedSku:[],selectedSkuIndex:[[]],specSelectedIndex:[],productSkus:[],selectedName:[],noSelectedName:[],specificationDefaultDisplay:{},specification:[],shoppingAttributes:[],getLists:this.getList,buyState:this.buy}},watch:{getList:function(t){this.$emit("getList",t),this.getLists=this.getList,this.update||this.loadData()},buy:function(t){this.buyState=t},getLists:function(t){this.$emit("getLists",t)},cartDetails:function(t){this.getLists=t.good,this.initSelectSpec(t)}},methods:{loadData:function(){var t=this;if(this.selectedSku=[],this.getLists.good_sku.length>0){var e=(0,s.param2Data)(this.getLists.good_sku),i=e.productSkus,o=e.specification;this.specification=o,o.forEach((function(e,i){t.specSelectedIndex.push(null),t.noSelectedName.push(e.value),e.leaf.forEach((function(e,s){t.selectedSku.push(e.id),t.selectedSkuIndex[e.id]={index:i,leaf:s}}))})),this.productSkus=i,i.forEach((function(e,i){e.data.forEach((function(e){e.sort((function(t,e){return parseInt(t.replace("sku",""))-parseInt(e.replace("sku",""))})),t.SKUResult[e.join("_")]=!0}))})),this.specificationDefaultDisplay={img:this.getLists.resources_many[0].img,price_show:this.getLists.price_show,inventory_show:this.getLists.inventory_show,selected:"选择 "+this.noSelectedName},this.$emit("purchasePattern","选择 "+this.noSelectedName)}else this.specificationDefaultDisplay={img:this.getLists.resources_many[0].img,price_show:this.getLists.price_show,inventory_show:this.getLists.inventory_show},this.cartGood.price=this.getLists.price;if("undefined"!=typeof this.specification[0].leaf[0])for(var n=0;n<this.specification.length;n++)this.selectSpec(n,0,this.specification[n].leaf[0])},initSelectSpec:function(t){var e=this;this.selectedSku=[],this.SKUResult=[],this.cartGood.price=t.price,this.cartGood.number=t.number,this.shoppingAttributes=t.good_sku,this.good_sku=t.good_sku;var i=[],o=[];if(t.good_sku){var n=(0,s.param2Data)(this.getLists.good_sku),r=n.productSkus,c=n.specification;this.specification=c,c.forEach((function(s,n){s.leaf.forEach((function(r,u){for(var a=0;a<t.good_sku.product_sku.length;a++)if(r.value===t.good_sku.product_sku[a].value){s.leaf[u].selected=!0,e.specSelectedIndex[n]=u,null!==u&&(i.push(c[n]["leaf"][u]["id"]),o.push(n));break}e.selectedSku.push(r.id),e.selectedSkuIndex[r.id]={index:n,leaf:u}}))})),this.productSkus=r,r.forEach((function(t,i){t.data.forEach((function(t){t.sort((function(t,e){return parseInt(t.replace("sku",""))-parseInt(e.replace("sku",""))})),e.SKUResult[t.join("_")]=!0}))}))}this.specificationDefaultDisplay={img:t.img,price_show:[t.good_sku.price],inventory_show:t.good_sku.inventory,selected:"已选 "+t.specification};var u=JSON.parse(JSON.stringify(this.selectedSku)),a=[];u.forEach((function(t){a=JSON.parse(JSON.stringify(i)),a.push(t),o.forEach((function(s,o){e.specification[s].leaf.forEach((function(e){e.id===t&&a.splice(a.indexOf(i[o]),1)}))})),a.sort((function(t,e){return parseInt(t.replace("sku",""))-parseInt(e.replace("sku",""))})),e.SKUResult[a.join("_")]?e.specification[e.selectedSkuIndex[t].index].leaf[e.selectedSkuIndex[t].leaf].disabled=!1:e.specification[e.selectedSkuIndex[t].index].leaf[e.selectedSkuIndex[t].leaf].disabled=!0}))},priceInput:function(t){this.cartGood.price=parseFloat(t.target.value)},selectSpec:function(t,e,i){var s=this;if(i.disabled)return!1;var o=!1,n=this.specification;this.specSelectedIndex[t]===e?(this.$set(n[t]["leaf"][e],"selected",!n[t]["leaf"][e]["selected"]),this.specSelectedIndex[t]=null,this.noSelectedName.splice(t,0,n[t].value)):(null!==this.specSelectedIndex[t]&&this.$set(n[t]["leaf"][this.specSelectedIndex[t]],"selected",!1),this.$set(n[t]["leaf"][e],"selected",!n[t]["leaf"][e]["selected"]),this.specSelectedIndex[t]=e,this.noSelectedName.forEach((function(e,i){e===n[t].value&&s.noSelectedName.splice(i,1)}))),this.noSelectedName.length>0&&(this.specificationDefaultDisplay={img:this.getLists.resources_many[0].img,price_show:this.getLists.price_show,inventory_show:this.getLists.inventory_show,selected:"选择 "+this.noSelectedName},this.update||this.$emit("purchasePattern","选择 "+this.noSelectedName)),this.specSelected=[];var r="",c=[],u=[],a=JSON.parse(JSON.stringify(this.selectedSku));this.specSelectedIndex.forEach((function(t,e){null!==t?(s.specSelected.push(n[e]["leaf"][t]),r+=n[e]["id"]+"-"+n[e]["leaf"][t]["id"]+"_",c.push(n[e]["leaf"][t]["id"]),a.splice(a.indexOf(n[e]["leaf"][t]["id"]),1),u.push(e),o=!0):o=!1}));var d=[];if(a.forEach((function(t){d=JSON.parse(JSON.stringify(c)),d.push(t),u.forEach((function(e,i){s.specification[e].leaf.forEach((function(e){e.id===t&&d.splice(d.indexOf(c[i]),1)}))})),d.sort((function(t,e){return parseInt(t.replace("sku",""))-parseInt(e.replace("sku",""))})),s.SKUResult[d.join("_")]?n[s.selectedSkuIndex[t].index].leaf[s.selectedSkuIndex[t].leaf].disabled=!1:n[s.selectedSkuIndex[t].index].leaf[s.selectedSkuIndex[t].leaf].disabled=!0})),!0===o){this.cartGood.number=1,this.shoppingAttributes=[];for(var h=0;h<this.productSkus.length;h++)if(this.productSkus[h].ids===r.substr(0,r.length-1)){var p=function(){s.specificationDefaultDisplay;var t=[];return s.productSkus[h].skus.forEach((function(e){t.push(e.v)})),s.specificationDefaultDisplay={img:s.productSkus[h].resources?s.productSkus[h].resources.img:s.getLists.resources_many[0].img,price_show:[s.productSkus[h].price],inventory_show:s.productSkus[h].inventory,selected:"已选 "+t.join(";"),cost_price:s.productSkus[h].cost_price},s.update||s.$emit("purchasePattern","已选 "+t.join(";")),s.cartGood.price=s.productSkus[h].price,s.shoppingAttributes=s.productSkus[h],"break"}();if("break"===p)break}}},numberChange:function(t){this.cartGood.number=t.number},cart:function(){if(this.shoppingAttributes.id>0||0===this.getLists.good_sku.length){var e=/^\d+\.?\d{0,2}$/;if(!e.test(this.cartGood.price))return t.showToast({icon:"none",title:"输入的金额有误",duration:2e3}),!1;if(this.$emit("toggleSpec"),this.order){if(this.getLists.good_sku.length>0){var i=this.getLists.resources_many[0].img;this.shoppingAttributes.resources&&(i=this.shoppingAttributes.resources.img);var s={id:this.cartDetails.id?this.cartDetails.id:0,name:this.getLists.name,price:this.cartGood.price,number:this.cartGood.number,good_sku_id:this.shoppingAttributes.id,good_id:this.getLists.id,good:this.getLists,good_sku:this.shoppingAttributes,img:i};this.$emit("setOrder",s)}}else{var o=t.getStorageSync("dsshopCartList")||{};this.buyState&&(o={});var n=this.getLists.resources_many[0].img;this.getLists.good_sku.length>0?(this.shoppingAttributes.resources&&(n=this.shoppingAttributes.resources.img),this.update&&this.good_sku.id!==this.shoppingAttributes.id&&delete o[this.good_sku.id],o[this.shoppingAttributes.id]?(this.update?o[this.shoppingAttributes.id].number=this.cartGood.number:o[this.shoppingAttributes.id].number+=this.cartGood.number,o[this.shoppingAttributes.id].number>this.specificationDefaultDisplay.inventory_show&&(o[this.shoppingAttributes.id].number=this.specificationDefaultDisplay.inventory_show),o[this.shoppingAttributes.id].price=this.cartGood.price,o[this.shoppingAttributes.id].name=this.getLists.name,o[this.shoppingAttributes.id].good_id=this.getLists.id,o[this.shoppingAttributes.id].good=this.getLists,o[this.shoppingAttributes.id].good_sku_id=this.shoppingAttributes.id,o[this.shoppingAttributes.id].good_sku=this.shoppingAttributes,o[this.shoppingAttributes.id].img=n):o[this.shoppingAttributes.id]={price:this.cartGood.price,number:this.cartGood.number,name:this.getLists.name,good_id:this.getLists.id,good:this.getLists,good_sku_id:this.shoppingAttributes.id,good_sku:this.shoppingAttributes,img:n}):o["good_"+this.getLists.id]?(this.update?o["good_"+this.getLists.id].number=this.cartGood.number:o["good_"+this.getLists.id].number+=this.cartGood.number,o["good_"+this.getLists.id].number>this.getLists.inventory_show&&(o["good_"+this.getLists.id].number=this.getLists.inventory_show),o["good_"+this.getLists.id].price=this.cartGood.price,o["good_"+this.getLists.id].name=this.getLists.name,o["good_"+this.getLists.id].good_id=this.getLists.id,o["good_"+this.getLists.id].good=this.getLists,o["good_"+this.getLists.id].img=n):o["good_"+this.getLists.id]={price:this.cartGood.price,number:this.cartGood.number,name:this.getLists.name,good_id:this.getLists.id,good:this.getLists,img:n},this.buyState?t.setStorageSync("dsshopOrderList",o):t.setStorageSync("dsshopCartList",o)}this.initList(),this.update||(this.buyState?t.navigateTo({url:"/pages/order/createOrder"}):t.showToast({title:"成功加入购物车",duration:2e3})),this.$emit("loadCart")}else t.showToast({icon:"none",title:"请选择规格",duration:2e3})},initList:function(){this.cartGood={number:1,price:""},this.specification=[],this.specificationDefaultDisplay=[],this.SKUResult=[],this.specSelected=[],this.specSelectedIndex=[],this.selectedName=[],this.noSelectedName=[],this.selectedSku=[],this.selectedSkuIndex=[[]],this.productSkus=[],this.shoppingAttributes=[],this.loadData()},previewImage:function(e){var i=[];i.push(e),t.previewImage({current:0,urls:i})}}};e.default=n}).call(this,i("543d")["default"])},"499f":function(t,e,i){"use strict";var s=i("e331"),o=i.n(s);o.a},c351:function(t,e,i){"use strict";var s;i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return s}));var o=function(){var t=this,e=t.$createElement;t._self._c},n=[]},da11:function(t,e,i){"use strict";i.r(e);var s=i("257b"),o=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,(function(){return s[t]}))}(n);e["default"]=o.a},e331:function(t,e,i){},f2f3:function(t,e,i){"use strict";i.r(e);var s=i("c351"),o=i("da11");for(var n in o)"default"!==n&&function(t){i.d(e,t,(function(){return o[t]}))}(n);i("499f");var r,c=i("f0c5"),u=Object(c["a"])(o["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);e["default"]=u.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/sku/index-create-component',
    {
        'components/sku/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("f2f3"))
        })
    },
    [['components/sku/index-create-component']]
]);
